<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Number guessing game</title>
</head>
<body>
  <h1>Number guessing game</h1>
  <p>
    I’m thinking of a number between
    <span id="lower">0</span> and
    <span id="upper">99</span>.
  </p>
  <p>
    <button id="guessButton" disabled>Guess:</button>
    <input type="text" id="guessedNumberInput" disabled>
  </p>
  <p id="feedback"></p>
  <p>
    <button id="startGameButton">Start new game</button>
  </p>

  <script type="module">
    /** Returns a random integer i with min <= i < max */
    const getRandomIntegerBetween = (min, max) => {
      return min + Math.floor(Math.random() * (max - min));
    };

    const LOWER = Number(document.querySelector('#lower').innerText);
    const UPPER = Number(document.querySelector('#upper').innerText);

    const guessButton = document.querySelector('#guessButton');
    const guessedNumberInput = document.querySelector('#guessedNumberInput');
    const feedback = document.querySelector('#feedback');
    const startGameButton = document.querySelector('#startGameButton');

    let randomNumber = undefined;
    const startGame = () => {
      randomNumber = getRandomIntegerBetween(LOWER, UPPER + 1);
      console.debug(randomNumber);
      // Remove feedback from previous game (if there was one)
      feedback.innerText = '';
      guessButton.disabled = false;
      guessedNumberInput.disabled = false;
    };

    const continueGame = (guessedNumber) => {
      //----- Error checks -----
      if (Number.isNaN(guessedNumber)) {
        feedback.innerText = '❌ Your guess must be a number!';
        return;
      }
      if (guessedNumber < LOWER || guessedNumber > UPPER) {
        // Parentheses are not required but help with readability
        feedback.innerText = (
          '❌ Your guess must be ' +
          'at least ' + LOWER + ' and ' +
          'at most ' + UPPER + '.'
        );
        return;
      }

      //----- Guess is valid – process it -----
      if (guessedNumber === randomNumber) {
        feedback.innerText = '✅ Your guess is correct!';
        guessButton.disabled = true;
        guessedNumberInput.disabled = true;
      } else if (guessedNumber < randomNumber) {
        feedback.innerText = 'Your guess is smaller than my number.';
      } else {
        // guessedNumber > randomNumber
        feedback.innerText = 'Your guess is larger than my number.';
      }
    };

    guessButton.addEventListener(
      'click',
      () => {
        const guessedNumberStr = guessedNumberInput.value;
        const guessedNumber = Number(guessedNumberStr);
        continueGame(guessedNumber);
      }
    );

    startGameButton.addEventListener(
      'click',
      () => {
        startGame();
      }
    );

    startGame();
  </script>
</body>
</html>